{# filepath: c:\Users\rocha\OneDrive\Escritorio\Sistema-POS-main\reports\templates\reports\reporte_caja.html #}
{% extends 'base.html' %}
{% load static %}
{% load humanize %}

{% block content %}
<div class="container mt-4">
        <h2>Detalle de Caja</h2>
        <div class="row">
                <div class="col-md-6">
                        <h4>Información de la Caja</h4>
                        <p><strong>ID de Caja:</strong> {{ caja.id }}</p>
                        <p><strong>Cajero:</strong> {{ caja.vendedor.username }}</p>
                        <p><strong>Sucursal:</strong> {{ caja.sucursal.nombre }}</p>
                        <p><strong>Fecha de Apertura:</strong> {{ caja.apertura|date:"d/m/Y H:i" }}</p>
                        <p>
                                <strong>Fecha de Cierre:</strong>
                                {% if caja.cierre %}
                                        {{ caja.cierre|date:"d/m/Y H:i" }}
                                {% else %}
                                        <em>Aún no se ha cerrado</em>
                                {% endif %}
                        </p>
                </div>
                <div class="col-md-6">
                        <h4>Resumen Financiero</h4>
                        <p><strong>Efectivo Inicial:</strong> {{ formatted_efectivo_inicial }}</p>
                        <p><strong>Total en Débito:</strong> {{ formatted_total_debito }}</p>
                        <p><strong>Total en Crédito:</strong> {{ formatted_total_credito }}</p>
                            <p><strong>Total en Transferencia:</strong> {{ formatted_total_transferencia }}</p>
                        <p><strong>Total en Efectivo:</strong> {{ formatted_total_efectivo }}</p>
                        <p><strong>Vuelto Entregado:</strong> {{ formatted_vuelto_entregado }}</p>
                        <p><strong>Total de Ventas:</strong> {{ formatted_total_ventas }}</p>
                        <p><strong>Efectivo Final en Caja:</strong> {{ formatted_efectivo_final }}</p>
                </div>
        </div>
        <div class="mt-3 d-flex gap-2 no-print">
                 <a href="{% url 'print_caja' caja.id %}" target="_blank" class="btn btn-secondary">Imprimir Detalle</a>
                 <button type="button" class="btn btn-danger" onclick="cerrarSesion()">Cerrar Sesión</button>
                 <a href="{% url 'abrir_caja' %}" class="btn btn-primary">Abrir Nueva Caja</a>
        </div>
</div>

<script>
function cerrarSesion(){
        if(confirm("¿Estás seguro de que deseas cerrar sesión?")){
                window.location.href = "{% url 'logout' %}";
        }
}
</script>
<style>
@media print {
  .no-print { display: none !important; }
}
</style>
{% endblock %}