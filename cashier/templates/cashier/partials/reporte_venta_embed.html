<div class="container mt-2">
  <h4 class="mb-2">Detalle de Venta #{{ venta.id }}</h4>
  <p><strong>Fecha:</strong> {{ venta.fecha|date:"d M Y, H:i" }}</p>
  <p><strong>Empleado:</strong> {{ venta.empleado.username }}</p>
  {# Caja vinculada oculta en embed del cajero #}
  {% if sucursal %}
    <p><strong>Sucursal:</strong> {{ sucursal.nombre }}</p>
  {% endif %}
  <p><strong>Tipo de Venta:</strong> {{ venta.get_tipo_venta_display }}</p>
  <p><strong>Forma de Pago:</strong> {{ venta.get_forma_pago_display }}</p>
  {% if venta.forma_pago in "debito credito transferencia" %}
    <p><strong>Número de Transacción:</strong> {{ venta.numero_transaccion }}</p>
  {% endif %}
  {% if venta.forma_pago == "transferencia" %}
    <p><strong>Banco:</strong> {{ venta.banco }}</p>
  {% endif %}
  <p><strong>Total:</strong> {{ formatted_total }}</p>
  {% if venta.forma_pago == "efectivo" %}
    <p><strong>Cliente Pagó:</strong> {{ formatted_cliente_paga }}</p>
    <p><strong>Vuelto Entregado:</strong> {{ formatted_vuelto_entregado }}</p>
  {% endif %}

  <h5 class="mt-3">Productos Vendidos:</h5>
  <div class="table-responsive">
    <table class="table table-bordered table-sm mb-0">
      <thead class="table-light">
        <tr>
          <th>Producto</th>
          <th>Cantidad</th>
          <th>Precio Unitario</th>
          <th>Subtotal</th>
        </tr>
      </thead>
      <tbody>
        {% for item in detalles %}
        <tr>
          <td>{{ item.producto.nombre }}</td>
          <td>{{ item.cantidad }}</td>
          <td>${{ item.precio_unitario|floatformat:"0" }}</td>
          <td>{{ item.formatted_subtotal }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
